# @package _global_

# This config is for >=1xA100 GPUs (80GB)

defaults:
  # HF transformer model name
  - override /model/encoder: umt5-xl
  # LR scheduler
  - override /model/scheduler: linear
  # Fabric Strategy
  - override /fabric/strategy: ddp

model:
  gradient_checkpointing: true

resources:
  num_workers: 2
  num_proc: 16
  omp_threads: ${int_div:${n_cpus:},2}

batch_size:
  effective: 32
  per_device: 32
  per_device_eval: 32
  per_device_predict: 512

collates:
  train:
    n_sections: 32 # sample `x` sections from the candidate `z` sections
    max_pos_sections: 8 # include at max `y` positive sections

fabric:
  precision: bf16-mixed
  accelerator: gpu
  strategy:
    static_graph: true
